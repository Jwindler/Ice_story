# 比较基因组：点图介绍与可视化

获得基因组后可以进行的主要比较分析之一是可视化与密切相关物种的同线性。基因组的许多特征可以通过良好的点图轻松突出显示。可以从这些点图中识别结构变化，例如倒置、删除、重复和插入。

基因组点图（Genome Dot Plot）是一种用于比较两个或多个基因组的工具。它通过在一个二维矩阵中绘制基因组序列的相似性来显示基因组之间的相对关系。点图中的每个点代表一个基因组中的一段序列，而整个图像则反映了序列之间的相似性和差异性。



## 流程

1. 序列比对：将要比较的基因组序列进行比对，以找到相似的区域。
2. 序列分割：将比对得到的相似区域切割成较短的片段，通常是几十到几百个碱基对。
3. 构建点图：将切割得到的片段在二维矩阵中表示。矩阵的行和列代表不同的基因组，而每个片段在矩阵中的位置则反映了其在各个基因组中的出现位置。
4. 着色和标记：根据相似性程度，将点图中的片段进行着色和标记。相似的片段通常以相同的颜色显示，而不相似的片段则以其他颜色显示。

您将需要两个基因组来生成点图。更高质量，最好是在染色体水平上的“参考”基因组（也称为目标基因组）和您的基因组（支架或重叠群都可以，但染色体是理想的），称为查询基因组。

![](https://s2.loli.net/2023/06/26/lyj3AGb5DLFY47q.png)



## 作用

1. 可视化基因组之间的相似性和差异性：通过点图，可以直观地比较不同基因组之间的相似性和差异性。相似的片段在点图中会显示为对角线或近似对角线的模式，而不相似的片段则显示为散布在其他位置的点。
2. 发现基因组重排和重复序列：点图可以帮助检测基因组重排（基因组内部序列顺序的改变）和重复序列（在同一基因组中出现多次的相似片段）。这对于研究基因组结构和进化过程非常重要。
3. 寻找基因组中的基因和功能元素：通过比较不同基因组的点图，可以定位基因和其他功能元素在基因组中的位置。相似的功能元素通常在点图中显示为具有相似模式的片段。
4. 基因组注释和比较基因组学研究：基因组点图是进行基因组注释和比较基因组学研究的重要工具之一。它可以帮助研究人员理解基因组的结构、功能和演化，并揭示基因组之间的关系。



## 实战

### minimap2 比对

```sh
minimap2 -x asm5 -t 36 ref.fa query.fa > result_minimap2.paf

# ref.fa 参考基因组
# query.fa 查询基因组
```



### 可视化

对于点图，我们将使用 dotPlotly。还有一个 R Shiny 应用程序，但可以绘制的文件大小有限制。而且，如果你上传像玉米对齐这样的复杂文件，它会非常缓慢，并且交互能力将无法使用。因此，我们将下载脚本并在本地运行它们以生成静态点图。



### clone

- 克隆软件代码

```sh
git clone https://github.com/tpoorten/dotPlotly.git
```



### run

- 运行

```sh
./dotPlotly/pafCoordsDotPlotly.R \
   -i result_minimap2.paf \
   -o ctg \
   -s -t -l 
```



### 结果

![](https://s2.loli.net/2023/06/26/kfaKOLqF9ehwdnS.png)
